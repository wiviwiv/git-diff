webpackJsonp([6],{"0984":function(t,e){},M9ic:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("fZjL"),i=s.n(n),a=s("zL8q"),r={name:"tabs-card-head",components:{"el-badge":a.Badge},props:{tabs:{type:Array,required:!0}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tabs-card-head"},t._l(t.tabs,function(e,n){return s("a",{key:n,staticClass:"tab-title",class:{active:t.$route.query[e.handle.key]===e.handle.value},attrs:{href:"javascript:;"},on:{click:function(s){t.$router.push(e.path)}}},[t._v("\n    "+t._s(e.name)+"\n  ")])}))},staticRenderFns:[]};var o=s("VU/8")(r,c,!1,function(t){s("Mp5J")},null,null).exports,l={name:"tabs-head",components:{"el-row":a.Row,"el-col":a.Col,TabsCardHead:o},data:function(){return{tabs:[{name:this.$t("instances.all"),path:"/instances",handle:{key:"state",value:void 0}},{name:this.$t("instances.running"),path:"/instances?state=running",handle:{key:"state",value:"running"}},{name:this.$t("instances.stopped"),path:"/instances?state=stopped",handle:{key:"state",value:"stopped"}}]}}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[e("el-col",[e("tabs-card-head",{attrs:{tabs:this.tabs}})],1)],1)},staticRenderFns:[]},u={name:"instances-view",components:{TabsHead:s("VU/8")(l,d,!1,null,null,null).exports},computed:{handleDescription:function(){var t=this.filterType.includes(this.$route.query.type)?this.$route.query.type:"all";return this.description[t]},state:function(){return i()(this.filterState).includes(this.$route.query.state)?this.$route.query.state:"All"}},watch:{$route:"handlerFilter"},data:function(){return{displayStyle:"card",popoverVisible:!1,stopPopover:!1,dialogVisible:!1,filterType:["auth","backend","bridge","hook"],filterState:{stopped:0,running:1},serviceType:"auth",serviceName:"",currentService:{},services:{},instanceList:[],displayList:[],serviceList:[],displayServiceList:[],description:{auth:this.$t("instances.authDesc"),backend:this.$t("instances.backendDesc"),bridge:this.$t("instances.bridgeDesc"),hook:this.$t("instances.hookDesc"),other:this.$t("instances.otherDesc")}}},methods:{loadData:function(){var t=this;this.$httpGet("/instances").then(function(e){t.instanceList=e.data.items,t.handlerFilter()}).catch(function(e){t.$message.error(e||t.$t("error.networkError"))})},hidePopover:function(){var t=this;this.popoverVisible=!0,setTimeout(function(){t.popoverVisible=!1},0)},loadService:function(t){var e=this;t&&(this.services[t]?this.currentService=this.services[t]:(this.currentService={},this.$httpGet("/services/"+t).then(function(s){e.services[t]=s.data,e.currentService=s.data}).catch()))},handleInstance:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments[1];e?this.$httpPut("/instances/"+s+"/start").then(function(){t.$message.success(t.$t("oper.startSuccess")),t.loadData()}).catch(this.handleError):(this.hidePopover(),this.$httpPut("/instances/"+s+"/stop").then(function(){t.$message.success(t.$t("oper.stopSuccess")),t.loadData()}).catch(this.handleError))},handleError:function(t){this.$message.error(t.message||this.$t("error.networkError"))},deleteInstance:function(t){var e=this;this.$confirm(this.$t("oper.confirmDelete"),"Notice",{confirmButtonClass:"confirm-btn",confirmButtonText:this.$t("oper.confirm"),cancelButtonClass:"cache-btn el-button--text",cancelButtonText:this.$t("oper.cancel"),type:"warning"}).then(function(){e.$httpDelete("/instances/"+t.id).then(function(){e.$message.success(e.$t("oper.deleteSuccess")),e.loadData()}).catch(function(t){e.$message.error(t.message||e.$t("error.networkError"))})}).catch()},handlerFilter:function(){var t=this;this.displayList=this.instanceList.filter(function(e){return!i()(t.filterState).includes(t.$route.query.state)||e.status===t.filterState[t.$route.query.state]})},handleService:function(){var t=this;this.dialogVisible=!0,this.serviceName="",this.$httpGet("/services").then(function(e){t.serviceList=e.data.items,t.handlerServiceListFilter()}).catch()},handlerServiceListFilter:function(){var t=this;this.serviceName="",this.displayServiceList=this.serviceList.filter(function(e){var s=!t.filterType.includes(e.type);return"other"===t.serviceType?s:t.serviceType===e.type})},handleCurrentChange:function(t){this.serviceName=t.name}},created:function(){this.loadData()}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"instances-view"},[s("div",{staticClass:"page-title"},[t._v("\n    "+t._s(t.$t("instances.instances"))+"\n    "),s("el-button",{staticClass:"confirm-btn",staticStyle:{float:"right"},attrs:{round:"",plain:"",type:"success",icon:"el-icon-plus",size:"medium",disable:t.$store.state.loading},on:{click:t.handleService}},[t._v("\n      "+t._s(t.$t("instances.createInstance"))+"\n    ")])],1),t._v(" "),s("tabs-head"),t._v(" "),s("div",{staticClass:"instances-list"},[s("el-row",{attrs:{gutter:20}},t._l(t.displayList,function(e,n){return s("el-col",{key:n,class:["instance-card",1===e.status?"running":"stopped"],attrs:{xs:24,sm:12,lg:8,xl:4}},[s("el-card",{staticClass:"el-card--self",nativeOn:{click:function(s){t.$router.push("/instances/"+e.id)}}},[s("i",{staticClass:"el-icon-close delete-btn",on:{click:function(s){s.stopPropagation(),t.deleteInstance(e)}}}),t._v(" "),s("div",{staticClass:"instance-card-top"},[s("div",{staticClass:"instance-card-icon"},["auth"===e.type?s("i",{staticClass:"fa fa-lock",attrs:{"aria-hidden":"true"}}):"backend"===e.type?s("i",{staticClass:"fa fa-floppy-o",attrs:{"aria-hidden":"true"}}):"bridge"===e.type?s("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}}):"hook"===e.type?s("i",{staticClass:"fa fa-toggle-off",attrs:{"aria-hidden":"true"}}):s("i",{staticClass:"fa fa-plug",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("div",{staticClass:"instance-card-name"},[s("h3",[t._v(t._s(e.name))])])]),t._v(" "),s("div",{staticClass:"instance-card-details"},[s("p",[t._v(t._s(e.descr))]),t._v(" "),s("el-popover",{attrs:{placement:"top",width:"200",trigger:"hover",title:e.service,"open-delay":100},on:{show:function(s){t.loadService(e.service)}}},[s("div",{staticClass:"instances-service-details",staticStyle:{"min-height":"50px"}},[t.currentService.name?s("div",[s("p",{staticClass:"desc--text"},[t._v(t._s(t.currentService.descr))]),t._v(" "),s("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.instances.running)+" "+t._s(t.$t("instances.running"))+"\n                  ")]),t._v(" "),s("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.instances.stopped)+" "+t._s(t.$t("instances.stopped"))+"\n                  ")]),t._v(" "),s("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.type)+"\n                  ")])],1):t._e()]),t._v(" "),s("el-tag",{attrs:{slot:"reference",type:"info",size:"mini"},slot:"reference"},[t._v("\n                "+t._s(e.service)+"\n              ")])],1)],1),t._v(" "),s("div",{staticClass:"instance-card-footer clear-fix"},[1===e.status?s("div",{staticClass:"instance-instance-status"},[s("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n                "+t._s(t._f("howLong")(e.createAt))+"\n              ")])],1):s("div",{staticClass:"instance-instance-status"},[s("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("\n                "+t._s(t.$t("instances.stopped"))+"\n              ")])],1),t._v(" "),s("div",{staticClass:"instance-active-btn"},[1===e.status?s("div",{staticClass:"stop-area"},[s("el-popover",{attrs:{placement:"left",value:t.popoverVisible}},[s("p",[t._v(t._s(t.$t("oper.confirmStop")))]),t._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{staticClass:"cache-btn",attrs:{type:"text",size:"mini"},on:{click:t.hidePopover}},[t._v("\n                      "+t._s(t.$t("oper.cancel"))+"\n                    ")]),t._v(" "),s("el-button",{attrs:{type:"success",size:"mini"},nativeOn:{click:function(s){t.handleInstance(!1,e.id)}}},[t._v("\n                      "+t._s(t.$t("oper.confirm"))+"\n                    ")])],1),t._v(" "),s("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},on:{click:function(t){t.stopPropagation()}},slot:"reference"},[t._v("\n                    "+t._s(t.$t("oper.stop"))+"\n                  ")])],1)],1):s("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(s){s.stopPropagation(),t.handleInstance(!0,e.id)}}},[t._v("\n                "+t._s(t.$t("oper.start"))+"\n              ")])],1)])])],1)}))],1),t._v(" "),s("el-dialog",{attrs:{width:"600px",title:t.$t("instances.selectServiceType"),visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-tabs",{on:{"tab-click":t.handlerServiceListFilter},model:{value:t.serviceType,callback:function(e){t.serviceType=e},expression:"serviceType"}},[s("el-tab-pane",{attrs:{name:"auth",label:t.$t("instances.auth")}},[t._v("\n        "+t._s(t.description.auth)+"\n      ")]),t._v(" "),s("el-tab-pane",{attrs:{name:"backend",label:t.$t("instances.backend")}},[t._v("\n        "+t._s(t.description.backend)+"\n      ")]),t._v(" "),s("el-tab-pane",{attrs:{name:"bridge",label:t.$t("instances.bridge")}},[t._v("\n        "+t._s(t.description.bridge)+"\n      ")]),t._v(" "),s("el-tab-pane",{attrs:{name:"hook",label:t.$t("instances.hook")}},[t._v("\n        "+t._s(t.description.hook)+"\n      ")]),t._v(" "),s("el-tab-pane",{attrs:{name:"other",label:t.$t("instances.other")}},[t._v("\n        "+t._s(t.description.other)+"\n      ")])],1),t._v(" "),s("div",{staticClass:"service-card"},[s("el-table",{ref:"serviceTable",staticClass:"el-table--public",attrs:{data:t.displayServiceList}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-radio",{attrs:{label:e.row.name},on:{change:function(s){t.handleCurrentChange(e.row)}},model:{value:t.serviceName,callback:function(e){t.serviceName=e},expression:"serviceName"}})]}}])})],1)],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"confirm-btn",attrs:{type:"success",size:"small",disabled:!t.serviceName},on:{click:function(e){t.$router.push("/instances/"+t.serviceName+"/create")}}},[t._v("\n        "+t._s(t.$t("instances.nextStep"))+"\n      ")])],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(u,p,!1,function(t){s("0984")},null,null);e.default=h.exports},Mp5J:function(t,e){}});